sum(w*(x-.1471))
sum(w*(x-.0025)^2)
sum(w*(x-.1471)^2)
sum(w*(x-.3)^2)
sum(w*(x-1.077)^2)
x<-c(.61,.93,.83,.35,.54,.16,.91,.62,.62)
y<-c(.67,.84,.6,.18,.85,.47,1.1,.65,.36)
ft<-lm(y~x);
ft
summary(ft)
summary(ft)$sigma
data(mtcars)
ft<-lm(mtcars$mpg~mtcars$weight)
summary(mtcars)
ft<-lm(mtcars$mpg~mtcars$wt)
ft[2,1]+c(-1,1)*qt(.95,df=ft$df)*ft[2,2]
sumft<-summary(ft)$coefficients
sumft[2,1]+c(-1,1)*qt(.95,df=sumft$df)*sumft[2,2]
sumft
sumft[2,1]+c(-1,1)*qt(.95,df=ft$df)*sumft[2,2]
sumft[2,1]+c(-1,1)*qt(.975,df=ft$df)*sumft[2,2]
summary(mcars)
summary(mtcars)
View(mtcars)
?mtcars
3000+c(-1,1)*qt(.975,df=ft$df)*sumft[2,2]
predict(fit,3000,interval=("confidence"))
predict(ft,3000,interval=("confidence"))
newdata<-data.frame(x=3000)
predict(ft,newdata,interval=("confidence"))
?predict
predict(ft,newdata
)
predict(ft,newdata)
summary(ft)
coef(ft)
p1<-coef(ft)[1]+coef(ft)[2]*3000
p1
p1<-coef(ft)[1]+coef(ft)[2]*3
p1
p1+c(-1,1)*qt(.975,df=ft$df)*sumft[2,2]
p1+c(-1,1)*qt(.95,df=ft$df)*sumft[2,2]
p1+c(-1,1)*qt(.975,df=ft$df)*sumft[2,2]
c(-1,1)*qt(.975,df=ft$df)*sumft[2,2]/2
sump[2,1]+c(-1,1)*qt(.975,df=ft$df)*sumft[2,2]/2
sumft[2,1]+c(-1,1)*qt(.975,df=ft$df)*sumft[2,2]/2
newx
newx<-c(3)
predict(fit,newdata=data.frame(wt=newdx))
predict(ft,newdata=data.frame(wt=newdx))
predict(ft,newdata=data.frame(wt=newx))
ft
ft<-lm(mcars$mpg~mcars$wt)
ft<-lm(mtcars$mpg~mtcars$wt)
ft
coet(ft)[1]+coef(ft)[2]*3
coef(ft)[1]+coef(ft)[2]*3
coef(ft)[1]+coef(ft)[2]*3+c(-1,1)*qt(.975,df=ft$dif)
coef(ft)[1]+coef(ft)[2]*3+c(-1,1)*qt(.975,df=ft$df)
coef(ft)[1]+coef(ft)[2]*3+c(-1,1)*qt(.975,df=ft$df)*coef(ft)[2]
coef(ft)[1]+coef(ft)[2]*3+c(-1,1)*qt(.975,df=ft$df)*sumft[2]
coef(ft)[1]+coef(ft)[2]*3+c(-1,1)*qt(.975,df=ft$df)*sumft[2,2]
newdata=data.frame(wt=3)
predict(ft,newdata,interval="predict")
newdta
newdata
ft<-lm(mpg~wt)
data<-data.frame(mtcars$mpg,mtcars$wt)
View(data)
rownames(data)<-c("mpg","wt")
colnames(data)<-c("mpg","wt")
View(data)
?lm
ft<-lm(mpg~wt,data=data)
ft
newdata
predict(ft,newdata,interval="predict")
ft2<-lm(mpg~I(wt*2),data=data)
summary(fit)
summary(ft2)
ft2$coefficients
sumft2<-summary(ft2)$coefficients
c(-1,1)*qt(.975,df=ft2$df)*sumft2[1,2]
ft2<-lm(mpg~I(wt/2),data=data)
sumft2<-summary(ft2)$coefficients
c(-1,1)*qt(.975,df=ft2$df)*sumft2[1,2]
ft2<-lm(mpg~I(wt/2),data=data)
data1<-data.frame(data$mpg,data$wt/2)
View(data)
View(data1)
ft2<-lm(mpg~I(wt/2),data=data)
sumft2<-summary(ft2)$coefficients
sumft2[1,1]+c(-1,1)*qt(.975,df=ft2$df)*sumft2[1,2]
c(-1,1)*qt(.975,df=ft2$df)*sumft2[1,2]
-1*1/sumft2[1,2]
ft2<-lm(I(wt/2)~mpg,data=data)
sumft2<-summary(ft2)$coefficients
c(-1,1)*qt(.975,df=ft2$df)*sumft2[1,2]
sumft2[1,1]+c(-1,1)*qt(.975,df=ft2$df)*sumft2[1,2]
ft2<-lm(mpg~I(wt/2),data=data)
sumft2<-summary(ft2)$coefficients
sumft2[1,1]+c(-1,1)*qt(.975,df=ft2$df)*sumft2[1,2]
c(-1,1)*qt(.975,df=ft2$df)*sumft2[1,2]
sumft2
ft2
ft2<-lm(mpg~I(wt/2),data=data)
ft2
sumft2[1,2]+c(-1,1)*qt(.975,df=ft2$df)*sumft2[1,2]
newdata<-data.frame(wt=1)
predict(ft2,newdata,interval="predict")
newdata<-data.frame(wt=0.5)
predict(ft2,newdata,interval="predict")
p<-cor(data1$mpg,data1$wt)^2
?cor
x<-data1$wt
y<-data1$mpg
cor(x,y)^2
cor(x=x,y=y)^2
ft2<-lm(mpg~I(wt/2),data=data)
newdata<-data.frame(wt=1)
predict(ft2,newdata,interval="confidential")
predict(ft2,newdata,interval="confidence")
ft2
ft1
ft
ft<-lm(mpg~wt,data=data)
ft
sumft2<-summary(ft2)$coefficients
sumft2
sumft2[2,2]
sumft2[2,1]
sumft2[2,1]+c(-1,1)*qt(.975)*sumft2[2,1]
sumft2[2,1]+c(-1,1)*qt(.975,df=ft2$df)*sumft2[2,1]
sumft2[1,1]+c(-1,1)*qt(.975,df=ft2$df)*sumft2[2,1]
sumft2[2,1]+c(-1,1)*qt(.975,df=ft2$df)*sumft2[2,2]
sumft2
View(sumft2)
e<-resid(ft)
yhat<-predict(ft)
e
e<-resid(ft2)
e
ft2
ft0<-data1$mpg-ft2[1,1]
ft0<-data1$mpg-ft2[1]
ft2
ft2(1)
ft2[1]
ft2[1][1]
sumft2
sumft2[1,1]
ft0<-data1$mpg-sumft2[1,1]
sum(resid(ft2)^2)/sum(ft0^2)
ft0
data1$mpg
View(data1)
colnames(data1)<-c("mpg","wt")
data1$mpg
ft0<-data1$mpg-sumft2[1,1]
ft0
sum(resid(ft2)^2)/sum(ft0^2)
yhat <- predict(ft)
yhat
re<-yhat-data$mpg
re
sum(re^2)/sum(ft0^2)
x<-c(.61,.93,.83,.35,.54,.16,.91,.62,.62)
y<-c(.67,.84,.6,.18,.85,.47,1.1,.65,.36)
x
y
ft<-lm(y~x)
ft
summary(ft)$coefficients
sumft2
sumft
sumft[2,1]+c(-1,1)*qt(.975,df=ft$dt)*sumft[2,2]
sumft[2,1]+c(-1,1)*qt(.975,df=ft$df)*sumft[2,2]
mean(data$mpg)+c(-1,1)*qt(.975,df=ft$df)*sumft[2,2]
?dfbeat
?dfbetas
library(datasets)
data(swiss)
require(stat)
install.packages("stats")
install.packages("stats")
install.packages("stats")
install.packages("stats")
require(graphics)
pairs(swiss,panel=panel.smooth,main="Swiss data",col=3+(swiss$Catholic)>50)
summary(km(Fertility~.,data=swiss))
summary(lm(Fertility~.,data=swiss))
summary(lm(Fertility~Agriculture,data=swiss))
n<-100;x2<-1:n;x1<-.01*x2+runif(n,-.1,.1);y=-x1+x2+rnorm(n,sd=.01)
summary(lm(y~x1))
summary(lm(y~x1+x2))
summary(lm(y~x1))$coef
summary(lm(y~x1+x2))$coef
lm(x1~x2)
lm(y~x1-x2)
lm(y-x2~x1-x2)
lm(Agriculture~Education)
head(swiss)
lm(Agriculture~Education)
summary(lm(Agriculture~Education,data=swiss))
summary(lm(Agriculture~Education,data=swiss)$coef
/
summary(lm(Agriculture~Education,data=swiss))$coef
lm(Agriculture~Education,data=swiss)
x<-c(.586,.166,-.042,-.614,11.72)
y<-c(.549,-.026,-.127,-.751,1.344)
fit<-lm(y~x)
round(hatvalues(fit)[1:5])
round(hatvalues(fit)[1:5],3)
round(hfbeats(fit)[1:5],3)
round(dfbeats(fit)[1:5],3)
round(dfbetas(fit)[1:5],3)
x<-c(.586,.166,-.042,-.614,11.72)
y<-c(.549,-.026,-.127,-.751,1.344)
fit<-lm(y~x)
round(hatvalues(fit)[1:5],3)
round(dfbetas(fit)[1:5],3)
x
y
round(dfbetas(fit),3)
library(mtcars)
data(mtcars)
head(mtcars)
fit<-lm(mpg~cyl)
fit<-lm(mpg~cyl,data=mtcars)
fit1<-lm(mpg~cyl+wt,data=mtcars)
summary(lm(mpg~I(1*(cyl=8))+I(1*(cy=6)),data=mtcars))
lm(mpg~I(1*(cyl==8))+I(1*(cy==6)),data=mtcars)
lm(mpg~I(1*(cyl==8))+I(1*(cyl==6)),data=mtcars)
lm(mpg~I(1*(cyl==8))+I(1*(cyl==4)),data=mtcars)
mtcars1<-data.frame(mtcars$mpg,mtcars$cyl,mtcars$wt)
lm(mpg~I(1*(cyl==8))+I(1*(cyl==6)),data=mtcars1)
head(mtcars1)
colnames(mtcars1)<-c('mpg','cyl','wt')
head(mtcars1)
lm(mpg~I(1*(cyl==8))+I(1*(cyl==6)),data=mtcars1)
summary(lm(mpg~I(1*(cyl==8))+I(1*(cyl==6)),data=mtcars1))$coef
summary(lm(mpg~I(1*(cyl==8))+I(1*(cyl==4)),data=mtcars1))$coef
mtcars3<-relevel(mtcars1$cyl,8)
head(mtcars1)
summary(mtcars1)
mtcars3<-relevel(mtcars1$cyl,"8")
mtcars3<-relevel(mtcars1$cyl,8)
lm(mpg~I(wt*0.5)+factor(cyl),data=mtcars)
lm(mpg~I(wt)+factor(cyl),data=mtcars)
mtcars2<-data.frame(mtcars$mpg,as.factor(mtcars$cyl),mtcars$wt)
colnames(mtcars2)<-c("mpg","cyl","wt")
mtcar3<-relevel(mtcars2$cyl,8)
View(mtcars2)
View(mtcars2)
mtcar3<-relevel(mtcars2$cyl,ref=8)
cyl8<-relevel(mtcars2$cyl,8)
mtcars2$cyl
cyl8<-relevel(mtcars2$cyl,3)
mtcars2$cyl
cyl8<-relevel(mtcars2$cyl,"8")
mtcars2$cyl
cyl8
cyl8<-relevel(mtcars2$cyl,8)
cyl8<-relevel(mtcars2$cyl,3)
cyl8
cyl8<-relevel(mtcars2$cyl,1)
cyl8
cyl2<-relevel(mtcars2$cyl,8)
cyl2<-relevel(mtcars$cyl,8)
cyl2<-relevel(as.factor(mtcars$cyl),8)
summary(lm(mpg~cyl-1,data=mtcars2))$coef
cyl2<-relevel(mtcars2$cyl,8)
cyl2<-relevel(mtcars2$cyl,ref="8")
cyl2
summary(lm(mpg~cyl,data=mtcars2))$coef
cyl2<-relevel(mtcars2$cyl,"8")
cyl2
cyl2<-relevel(mtcars2$cyl,3)
cyl2
cyl2<-relevel(mtcars2$cyl,2)
cyl2
mtcars2$cyl
relevel(mtcars2$cyl,8)
relevel(mtcars2$cyl,1:3)
relevel(mtcars2$cyl,3)
relevel(mtcars2$cyl,2)
relevel(mtcars2$cyl,ref="8")
cyl<-as.character(mtcars$cyl)
cyl1<-as.factor(cyl)
cyl1
relevel(cyl1,"8")
relevel(cyl1,8)
mtcars2[order(mtcars2$cyl,decreasing=TRUE)
]
mtcars2[order(mtcars2$cyl,decreasing=TRUE)]
mtcars2[,order(mtcars2$cyl,decreasing=TRUE)]
y<-mtcars2[order(mtcars2$cyl,decreasing=TRUE)]
y<-mtcars2[mtcars2[order(mtcars2$cyl,decreasing=TRUE)]]
y<-mtcars2[,mtcars2[order(mtcars2$cyl,decreasing=TRUE)]]
y<-mtcars2[:,mtcars2[order(mtcars2$cyl,decreasing=TRUE)]]
y<-mtcars2[:,mtcars2[order(mtcars2$cyl,decreasing=TRUE)]]
mtcars2[with(mtcars2,order(mtcars2$cyl,decreasing=TRUE))]
mtcars2[with(mtcars2,order(mtcars2$cyl,decreasing=TRUE)),]
mtcars3<-mtcars2[with(mtcars2,order(mtcars2$cyl,decreasing=TRUE)),]
lm(mpg~cyl+wt,data=mtcars3)
summary(lm(mpg~cyl+wt,data=mtcars3))$coef
summary(lm(mpg~cyl,data=mtcars3))$coef
summary(lm(mpg~cyl+wt,data=mtcars))$coef
summary(lm(mpg~cyl,data=mtcars))$coef
summary(lm(mpg~cyl,data=mtcars2))$coef
summary(lm(mpg~cyl+wt,data=mtcars2))$coef
data(mtcars)
data(mtcars)
data(mtcars)
View(mtcars)
?mtcars
lm(mpg~am,data=mtcars)
summary(lm(mpg~am-1,data=mtcars))$coef
summary(lm(mpg~I(1*(am==1)),data=mtcars))$coef
summary(lm(mpg~I(1*(am==1)-1),data=mtcars))$coef
summary(lm(mpg~am-1,data=mtcars))$coef
summary(lm(mpg ~ am-1,data=mtcars))$coef
summary(lm(mpg~I(1*(am==0))+I(1*(am==1)-1),data=mtcars))$coef
summary(lm(mpg~I(1*(am==0))+I(1*(am==1))-1),data=mtcars))$coef
summary(lm(mpg~I(1*(am==0))+I(1*(am==1))-1,data=mtcars))$coef
lm(mpg ~ am, dataset=mtcars)
summary(lm(mpg ~ am, data=mtcars))$coef
17.147+7.245
summary(lm(mpg ~ ., data=mtcars))$coef
library(MASS)
head(mass)
head(MASS)
?shuttle
head(shuttle)
View(mtcars)
shuttle$use[shuttle$use == "auto"]<-1
shuttle$use[shuttle$use == auto]<-1
levels(shuttle$use) <- c(levels(shuttle$use), 1, 0)
shuttle$use[shuttle$use == auto]<-1
shuttle$use[shuttle$use == "auto"]<-1
shuttle$use[shuttle$use == "noauto"]<-0
View(shuttle)
library(MASS)
head(shuttle)
shuttle["usenum"]<-NA
shuttle$usenum[shuttle$use == "auto"] <- 1
View(shuttle)
shuttle$usenum[shuttle$use == "noauto"] <- 0
shuttle["windnum"]<-NA
shuttle$windnum[shuttle$wind == "head"] <- 1
shuttle$windnum[shuttle$wind == "tail"] <- 0
View(shuttle)
loguse <- glm(usenum ~ windnum, data=shuttle, family="binomial")
summary(loguse)
exp(loguse$coef)
shuttle["magnnum"]<-NA
shuttle$magnnum[shuttle$magn == "Light"] <- 1
shuttle$magnnum[shuttle$magn == "Medium"] <- 2
shuttle$magnnum[shuttle$magn == "Strong"] <- 3
shuttle$magnnum[shuttle$magn == "Out of Range"] <- 4
View(shuttle)
shuttle$magnnum[shuttle$magn == "Out"] <- 4
View(shuttle)
loguse1 <- glm(usenum ~ windnum+magnnum, data=shuttle, family="binomial")
exp(loguse1$coef)
loguse2 <- glm(usenum ~ windnum+magn, data=shuttle, family="binomial")
exp(loguse2$coef)
data(InsectSprays)
glm1<-glm(count ~ spray, data=InsectSprays, family="poisson")
exp(glm1$coef)
14.5/1.0574713
glm1<-glm(count ~ spray-1, data=InsectSprays, family="poisson")
exp(glm1$coef)
14.5/15.3333
x<--1:5
y<-c(5.12, 3.93, 2.67, 1.87, 0.52, 0.08, 0.93, 2.05, 2.54, 3.87, 4.97)
x<- -5:5
knots <- 0
spLineTerm <- sapply(knots, function(knots) (x>knots)*(x-knots))
xMat <- cbind(1,x, spLineTerm)
View(xMat)
lm(y ~ xMat-1)
z <- lm(y ~ xMat-1)
summary(z$coef)
summary(z)
yhat <- predict(lm(y ~ xMat-1))
x
y
(0.93-0.08)/1
swirl()
library(swirl)
library(swirl)
install.packages("swirl")
library(swirl)
swirl()
swirl()
bye()
swirl
swirl()
fit <- lm(child ~ parent,data=galton)
summary(fit)
mean(fit$residuals)
cov(fit$residuals, galton$parent)
ols.ic <- fit$coef[1]
ols.slope <- fit$coef[2]
lhs-rhs
all.equal(lhs,rhs)
varChild <- var(galton$child)
varRes <- var(fit$residuals)
?est
varEst <- var(est(ols.ic,ols.slope))
varEst <- var(est(ols.slope,ols.ic))
all.equal(varChild,varRes+varEst)
efit <- lm(accel ~ mag+dist,attenu)
mean(efit$residual)
mean(efit$residuals)
cov(efit$residuals,attenu$mag)
cov(efit$residuals,attenu4dist)
cov(efit$residuals,attenu$dist)
cor(gpa_nor,gch_nor)
l_nor <- lm(gch_nor ~ gpa_nor)
fit <- lm(child ~ parent, data=galton)
fit <- lm(child ~ parent, galton)
sum(fit$residuals^2)/(928-2)
sqrt(sum(fit$residuals^2)/(928-2))
sqrt(sum(fit$residuals^2)/(n-2))
summary(fit)$sigma
sqrt(deviance(fit)/n-2)
sqrt(deviance(fit)/(n-2))
mu <- mean(galton$child)
sTot <- sum((galton$child-mu)^2)
sRes <- deviance(fit)
R^2<-1-sRes/sTot
1-sRes/sTot
summary(fit)$r
summary(fit)$r.square
summary(fit)$r.squared
sqrt(cor(galton$child,galton$parent))
cor(galton$child,galton$parent)^2
swirl()
library(swirl)
swirl()
dim(hunger)
943
948
names(hunger)
fit <- lm(Numeric ~ Year, hunger)
summary(fit)$coef
hunger1 <- hunger[hunger$sex="Female"]
hunger1 <- hunger[hunger$sex=="Female"]
lmF <- lm(hunger$Numeric[hunger$Sex=="Female"] ~ hunger$Year[hunger$Sex=="Female"])
lmM <- lm(Numeric[Sex=="Male"] ~ Year[Sex=="Male"],hunger)
lmBoth <- lm(Numeric ~ Year + Sex, hunger)
summary(lmBoth)
lmInter <- lm(Numeric ~ Year + Sex +Sex*Year,hunger)
summary(lmInter)
fit <- lm(y ~ x, out2)
plot(fit, which=1)
fitno <- lm(y ~ x, out2[-1,])
plot(fitno, which=1)
coef(fit) - coef(fitno)
head(dfbeta(fit))
resno <- out2[1,"y"]-predict(fitno,out2[1,])
1-resid(fit)[1]/resno
head(hatvalues(fit))
sigma <- resid(fit)^2
sigma <- sqrt(deviance(fit)/df.residual(fit))
rstd <- sigma*sqrt(1-hatvalue(fit))
rstd <- sigma*sqrt(1-hatvalues(fit))
rstd <- resid(fit)/(sigma*sqrt(1-hatvalues(fit)))
head(cbind(rstd,rstandard(fit)))
plot(fit, which=3)
plot(fit, which=2)
sigma1 <- sqrt(deviance(fitno)/df.residual(fitno))
resid(fit)[1]/(sigma1*sqrt(1-hatvalues(fit)[1]))
head(rstudent(fit))
dy <- predict(fit,out2)-predict(fitno,out2)
sum(dy^2)/(2*sigma^2)
plot(fit,which=5)
rgpa1()
rgp1()
rgp2()
head(swiss)
mdl <- lm(Fertility ~., swiss)
vif(mdl)
mdl2 <- lm(Feritility ~ Agriculture+Education+Catholic+Infant.Mortality,swiss)
mdl2 <- lm(Fertility ~ Agriculture+Education+Catholic+Infant.Mortality,swiss)
vif(mdl2)
x1c <- simbias()
apply(x1c,1,mean)
fit1 <- lm(Fertility ~ Agriculture, swiss)
fit3 <- lm(Fertility ~ Agriculture+Examination+Education, swiss)
anova(fit1,fit3)
deviance(fit3)
d <- deviance(fit3)/43
n <- (deviance(fit1)-deviance(fit3))/2
n/d
pf(n/3,2,43,lower.tail=FALSE)
pf(n/d,2,43,lower.tail=FALSE)
shapiro.test(fit3$residuals)
anova(fit1, fit3, fit5, fit6)
ravenData
mdl <- glm(ravenWinNum ~ ravenScore, family="binomial",ravenData)
lodds <- predict(mdl, data.frame(ravenScore=c(0,3,6)))
exp(lodds)/(1+exp(lodds))
summary(mdl)
confint(mdl)
exp(confint(mdl))
anova(mdl)
qchisq(0.95,1)
setwd("E:\\Coursera\\PraticalML_Homework")
library(caret)
